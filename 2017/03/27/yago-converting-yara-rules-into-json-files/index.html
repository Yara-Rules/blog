<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>YaGo, converting Yara rules into JSON files  &middot; YaraRules Project</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="Yara-Rules project web site" />



<meta name="keywords" content="Yara, Rules, ">




<meta property="og:title" content="YaGo, converting Yara rules into JSON files  &middot; YaraRules Project ">
<meta property="og:site_name" content="YaraRules Project"/>
<meta property="og:url" content="https://yara-rules.github.io/blog/2017/03/27/yago-converting-yara-rules-into-json-files/" />
<meta property="og:locale" content="en-EN">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2017-03-27T00:00:00Z" />
<meta property="og:article:modified_time" content="2017-03-27T00:00:00Z" />



  
<meta property="og:article:tag" content="yara">
  
<meta property="og:article:tag" content="rules">
  
<meta property="og:article:tag" content="yago">
  
<meta property="og:article:tag" content="json">
  


  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@yararules" />
<meta name="twitter:creator" content="@yararules" />
<meta name="twitter:title" content="YaGo, converting Yara rules into JSON files" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="https://yara-rules.github.io/blog/2017/03/27/yago-converting-yara-rules-into-json-files/" />
<meta name="twitter:domain" content="https://yara-rules.github.io/blog/">
  





<link rel="canonical" href="https://yara-rules.github.io/blog/2017/03/27/yago-converting-yara-rules-into-json-files/" />

<link rel="apple-touch-icon" sizes="57x57" href="/img/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/img/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/img/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/img/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/img/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/img/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/img/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/img/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/img/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/img/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png">
<link rel="icon" type="image/x-icon" href="/img/favicon/favicon.ico">
<link rel="manifest" href="/img/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/img/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


<meta name="generator" content="Hugo 0.38" />

  
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link href='https://fonts.googleapis.com/css?family=Merriweather:300%7CRaleway%7COpen+Sans' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="https://yara-rules.github.io/blog/css/font-awesome.min.css">
<link rel="stylesheet" href="https://yara-rules.github.io/blog/css/style.css">
<link rel="stylesheet" href="https://yara-rules.github.io/blog/css/highlight/default.css">

  
  
</head>
<body>
  <main id="main-wrapper" class="container main_wrapper has-sidebar">
    <header id="main-header" class="container main_header">
  <div class="container brand">
  <div class="container title h1-like">
  <a class="baselink" href="https://yara-rules.github.io/blog/">
  YaraRules

</a>

</div>

  
<div class="container topline">
  
  Yara Rules Repository


</div>


</div>

  <nav class="container nav primary no-print">
  

<a class="homelink" href="https://yara-rules.github.io/blog/">Home</a>


  
<a href="https://yara-rules.github.io/blog/project">Project</a>

<a href="https://github.com/Yara-Rules/rules">YaraRules Repository</a>

<a href="https://yara-rules.github.io/blog/post" title="Show list of blog posts">Blog</a>

<a href="https://yara-rules.github.io/blog/contribute">Contribute</a>

<a href="https://yara-rules.github.io/blog/contact">Contact</a>


</nav>

<div class="container nav secondary no-print">
  
<a id="contact-link-email" class="contact_link" href="mailto:yararules@gmail.com">
  <span class="fa fa-envelope-square"></span><span>email</span></a>



<a id="contact-link-github" class="contact_link" href="https://github.com/Yara-Rules/rules">
  <span class="fa fa-github-square"></span><span>github</span></a>











<a id="contact-link-twitter" class="contact_link" href="https://twitter.com/yararules">
  <span class="fa fa-twitter-square"></span><span>twitter</span></a>













</div>


  

</header>


<article id="main-content" class="container main_content single">
  <header class="container hat">
  <h1>YaGo, converting Yara rules into JSON files
</h1>

  <div class="metas">
<time datetime="2017-03-27">27 Mar, 2017</time>


  
    &middot; by Jaume Martin (@Xumeiquer)
  
  &middot; Read in about 3 min
  &middot; (563 Words)
  <br>
  
<a class="label" href="https://yara-rules.github.io/tags/yara">yara</a>

<a class="label" href="https://yara-rules.github.io/tags/rules">rules</a>

<a class="label" href="https://yara-rules.github.io/tags/yago">yago</a>

<a class="label" href="https://yara-rules.github.io/tags/json">json</a>



</div>

</header>

  <div class="container content">
  <p>Yara-Rules project is proud to anounce YaGo. YaGo is a tool that converts Yara rules into JSON files, that&rsquo;s it, simple.</p>

<p>Yara has a great comunity that use it and use a lot of rules, but sometimes it is hard to manage all of them, it is difficult to get a bird&rsquo;s eye view of your rule set so we thought coverting the rules in json format will help.</p>

<p>YaGo can be used as a standalone application or you can embed it on your own application. In adition, we haved licensed YaGo using Apache License v2 so you can use it as you want in your projects. In any way, we hope you to colaborate with us improving YaGo and Yara-Rules in general.</p>

<p>Using YaGo is really simple, for example this is its command line options.</p>

<pre><code class="language-md">./yago
  yago fileName &lt;fileName&gt; [ --validJSON ]
  yago dirName &lt;dirName&gt; [ --validJSON ]
  yago indexFile &lt;indexFile&gt; [ cwd &lt;path&gt; ] [ --validJSON ]
  yago inputFile &lt;inputFile&gt; outputDir &lt;outputDir&gt; [ --overwrite ] [ --validJSON ]
  yago inputFile &lt;inputFile&gt; outputFile &lt;outputFile&gt; [ --overwrite ] [ --validJSON ]
  yago -h | --help
  yago --version
</code></pre>

<p>The easyest execution is:</p>

<pre><code class="language-json">yago fileName test/EK_Zeus.yar

{&quot;file_name&quot;:&quot;EK_Zeus.yar&quot;,&quot;imports&quot;:null,&quot;rules&quot;:[{&quot;name&quot;:&quot;zeus_js&quot;,&quot;global&quot;:false,&quot;private&quot;:false,&quot;tags&quot;:[&quot;EK&quot;],&quot;meta&quot;:{&quot;author&quot;:&quot;Josh Berry&quot;,&quot;date&quot;:&quot;2016-06-26&quot;,&quot;description&quot;:&quot;Zeus Exploit Kit Detection&quot;,&quot;hash0&quot;:&quot;c87ac7a25168df49a64564afb04dc961&quot;,&quot;sample_filetype&quot;:&quot;js-html&quot;,&quot;yaragenerator&quot;:&quot;https://github.com/Xen0ph0n/YaraGenerator&quot;},&quot;strings&quot;:[{&quot;name&quot;:&quot;$string0&quot;,&quot;value&quot;:&quot;var jsmLastMenu &quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string1&quot;,&quot;value&quot;:&quot;position:absolute; z-index:99' &quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string2&quot;,&quot;value&quot;:&quot; -1)jsmSetDisplayStyle('popupmenu' &quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string3&quot;,&quot;value&quot;:&quot; '\u003ctr\u003e\u003ctd\u003e\u003ca href&quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string4&quot;,&quot;value&quot;:&quot;  jsmLastMenu &quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string5&quot;,&quot;value&quot;:&quot;  var ids &quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string6&quot;,&quot;value&quot;:&quot;this.target&quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string7&quot;,&quot;value&quot;:&quot; jsmPrevMenu, 'none');&quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string8&quot;,&quot;value&quot;:&quot;  if(jsmPrevMenu &quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string9&quot;,&quot;value&quot;:&quot;)if(MenuData[i])&quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string10&quot;,&quot;value&quot;:&quot; '\u003cdiv style&quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string11&quot;,&quot;value&quot;:&quot;popupmenu&quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string12&quot;,&quot;value&quot;:&quot;  jsmSetDisplayStyle('popupmenu' &quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string13&quot;,&quot;value&quot;:&quot;function jsmHideLastMenu()&quot;,&quot;modifers&quot;:null,&quot;type&quot;:1},{&quot;name&quot;:&quot;$string14&quot;,&quot;value&quot;:&quot; MenuData.length; i&quot;,&quot;modifers&quot;:null,&quot;type&quot;:1}],&quot;condition&quot;:&quot;14 of them&quot;}]}
</code></pre>

<p>You can use <code>jq</code> to see the output much clear.</p>

<pre><code class="language-json">yago fileName test/EK_Zeus.yar | jq .
{
  &quot;file_name&quot;: &quot;EK_Zeus.yar&quot;,
  &quot;imports&quot;: null,
  &quot;rules&quot;: [
    {
      &quot;name&quot;: &quot;zeus_js&quot;,
      &quot;global&quot;: false,
      &quot;private&quot;: false,
      &quot;tags&quot;: [
        &quot;EK&quot;
      ],
      &quot;meta&quot;: {
        &quot;author&quot;: &quot;Josh Berry&quot;,
        &quot;date&quot;: &quot;2016-06-26&quot;,
        &quot;description&quot;: &quot;Zeus Exploit Kit Detection&quot;,
        &quot;hash0&quot;: &quot;c87ac7a25168df49a64564afb04dc961&quot;,
        &quot;sample_filetype&quot;: &quot;js-html&quot;,
        &quot;yaragenerator&quot;: &quot;https://github.com/Xen0ph0n/YaraGenerator&quot;
      },
      &quot;strings&quot;: [
        {
          &quot;name&quot;: &quot;$string0&quot;,
          &quot;value&quot;: &quot;var jsmLastMenu &quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string1&quot;,
          &quot;value&quot;: &quot;position:absolute; z-index:99' &quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string2&quot;,
          &quot;value&quot;: &quot; -1)jsmSetDisplayStyle('popupmenu' &quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string3&quot;,
          &quot;value&quot;: &quot; '&lt;tr&gt;&lt;td&gt;&lt;a href&quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string4&quot;,
          &quot;value&quot;: &quot;  jsmLastMenu &quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string5&quot;,
          &quot;value&quot;: &quot;  var ids &quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string6&quot;,
          &quot;value&quot;: &quot;this.target&quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string7&quot;,
          &quot;value&quot;: &quot; jsmPrevMenu, 'none');&quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string8&quot;,
          &quot;value&quot;: &quot;  if(jsmPrevMenu &quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string9&quot;,
          &quot;value&quot;: &quot;)if(MenuData[i])&quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string10&quot;,
          &quot;value&quot;: &quot; '&lt;div style&quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string11&quot;,
          &quot;value&quot;: &quot;popupmenu&quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string12&quot;,
          &quot;value&quot;: &quot;  jsmSetDisplayStyle('popupmenu' &quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string13&quot;,
          &quot;value&quot;: &quot;function jsmHideLastMenu()&quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        },
        {
          &quot;name&quot;: &quot;$string14&quot;,
          &quot;value&quot;: &quot; MenuData.length; i&quot;,
          &quot;modifers&quot;: null,
          &quot;type&quot;: 1
        }
      ],
      &quot;condition&quot;: &quot;14 of them&quot;
    }
  ]
}
</code></pre>

<p>You can use mongo or a ELK stack to store and organize your rules as well as manage your own rule set. By default YaGo prints out the rules in a way to be able to import them into mongo o logstash.</p>

<p>For example:</p>

<pre><code>yago dirName rules_dir | mongoimport --db yararules --collection rules --type json
</code></pre>

<p>Or</p>

<pre><code>mongoexport --db yararules --collection rules --type json &gt; rules.json ; yago inputFile rules.json outputFile rules.yar
</code></pre>

<p>If you want to get more of YaGo go to <a href="https://github.com/Yara-Rules/yago">https://github.com/Yara-Rules/yago</a> and start playing with it. There is documentation in the repo as wll as a full list of examples.</p>

</div>


  <footer class="container">
  <div class="container navigation no-print">
  <h2>Navigation</h2>
  
  

    
    <a class="prev" href="https://yara-rules.github.io/blog/2017/03/08/website-redesign/" title="Website Redesign">
      Previous
    </a>
    

    
    <a class="next" href="https://yara-rules.github.io/blog/2017/04/06/yara-rules-strings-statistical-study/" title="Yara Rules Strings: Statistical study">
      Next
    </a>
    

  


</div>

  
</footer>

</article>
      <footer id="main-footer" class="container main_footer">
  

  <div class="container nav foot no-print">
  

  <a class="toplink" href="#">back to top</a>

</div>

  <div class="container credits">
  
<div class="container footline">
  
  Coded with <i class='fa fa-heart'></i>


</div>


  
<div class="container copyright">
  
  &copy; 2017 YaraRules Project.


</div>


</div>

</footer>

    </main>
    


<script src="https://yara-rules.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


    
  </body>
</html>

