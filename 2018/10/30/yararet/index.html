<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>YaraRET  &middot; YaraRules Project</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="Yara-Rules project web site" />



<meta name="keywords" content="yara, radare2, forensics, go, ">




<meta property="og:title" content="YaraRET  &middot; YaraRules Project ">
<meta property="og:site_name" content="YaraRules Project"/>
<meta property="og:url" content="https://yararules.com/2018/10/30/yararet/" />
<meta property="og:locale" content="en-EN">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2018-10-30T22:43:54&#43;01:00" />
<meta property="og:article:modified_time" content="2018-10-30T22:43:54&#43;01:00" />



  
<meta property="og:article:tag" content="yara">
  
<meta property="og:article:tag" content="radare2">
  
<meta property="og:article:tag" content="forensics">
  
<meta property="og:article:tag" content="go">
  


  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@yararules" />
<meta name="twitter:creator" content="@yararules" />
<meta name="twitter:title" content="YaraRET" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="https://yararules.com/2018/10/30/yararet/" />
<meta name="twitter:domain" content="https://yararules.com/">
  





<link rel="canonical" href="https://yararules.com/2018/10/30/yararet/" />

<link rel="apple-touch-icon" sizes="57x57" href="/img/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/img/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/img/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/img/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/img/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/img/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/img/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/img/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/img/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/img/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png">
<link rel="icon" type="image/x-icon" href="/img/favicon/favicon.ico">
<link rel="manifest" href="/img/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/img/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


<meta name="generator" content="Hugo 0.63.2" />

  
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link href='https://fonts.googleapis.com/css?family=Merriweather:300%7CRaleway%7COpen+Sans' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="https://yararules.com/css/font-awesome.min.css">
<link rel="stylesheet" href="https://yararules.com/css/style.css">
<link rel="stylesheet" href="https://yararules.com/css/highlight/default.css">

  
  
</head>
<body>
  <main id="main-wrapper" class="container main_wrapper has-sidebar">
    <header id="main-header" class="container main_header">
  <div class="container brand">
  <div class="container title h1-like">
  <a class="baselink" href="https://yararules.com/">
  YaraRules

</a>

</div>

  
<div class="container topline">
  
  Yara Rules Repository


</div>


</div>

  <nav class="container nav primary no-print">
  

<a class="homelink" href="https://yararules.com/">Home</a>


  
<a href="https://yararules.com/project">Project</a>

<a href="https://analysis.yararules.com">YaraRules Analyzer</a>

<a href="https://github.com/Yara-Rules/rules">YaraRules Repository</a>

<a href="https://yararules.com/post" title="Show list of blog posts">Blog</a>

<a href="https://yararules.com/contribute">Contribute</a>

<a href="https://yararules.com/contact">Contact</a>


</nav>

<div class="container nav secondary no-print">
  
<a id="contact-link-email" class="contact_link" href="mailto:yararules@gmail.com">
  <span class="fa fa-envelope-square"></span><span>email</span></a>



<a id="contact-link-github" class="contact_link" href="https://github.com/Yara-Rules/rules">
  <span class="fa fa-github-square"></span><span>github</span></a>











<a id="contact-link-twitter" class="contact_link" href="https://twitter.com/yararules">
  <span class="fa fa-twitter-square"></span><span>twitter</span></a>













</div>


  

</header>


<article id="main-content" class="container main_content single">
  <header class="container hat">
  <h1>YaraRET
</h1>

  <div class="metas">
<time datetime="2018-10-30">30 Oct, 2018</time>


  
    &middot; by Joan Soriano (@w0lfvan)
  
  &middot; Read in about 2 min
  &middot; (321 Words)
  <br>
  
<a class="label" href="https://yararules.com/tags/yara">yara</a>

<a class="label" href="https://yararules.com/tags/radare2">radare2</a>

<a class="label" href="https://yararules.com/tags/forensics">forensics</a>

<a class="label" href="https://yararules.com/tags/go">go</a>



</div>

</header>

  <div class="container content">
  <p>For this forensics cases which are based in unreliable evidences, we decided to carry out the development of a carving tool for getting files from a raw disk using IoC detection.</p>
<p>YaraRET itâ€™s based in Radare2 and Yara, and  it provides 58 magic number&rsquo;s rules for detecting 58 types of files.
This tool relies on the idea of a first stage detecting files using its magic numbers and a second stage, selecting or discarding those detected files using Yara, IoCs or its entropy value. After that, we can generate the hash, the ssdeep to check it over another files or upload the structure to VirusTotal.</p>
<p>YaraRET can be used as a oneliner or in a shell mode.</p>
<h2 id="oneliner">Oneliner</h2>
<p>If you want to run a fast scan over a disk, you can execute YaraRET in oneliner mode.</p>
<p>In this case, YaraRET runs the ruleset marked as yarafile and, if some rule has a match, YaraRET will look for magic numbers for detecting file structures around this match. If some result has been found, YaraRET will dump this file.</p>
<pre><code>$  ./yaraRET yara myYaraRule rawdisk myRaw maxsize maxsizeValue 
</code></pre><p>In the following example, YaraRET has searched for files related to TRISIS malware and a pyc file has been found.</p>
<p>Like with yara rules, YaraRET can parse a file with domains or IPs in it, for look for them in a raw disk.</p>
<pre><code>$ ./yaraRET ioc ./myIOC.stix rawdisk myRaw maxsize maxsizeValue
</code></pre><h2 id="shell-mode">Shell Mode</h2>
<p>For running a complex analysis, YaraRET adds a shell mode which allows selection of file structures based in Yara or IoC detection or its entropy. Also, provides a flexible way for footer assignment.</p>
<pre><code>$ ./yaraRET rawdisk myRaw shell
</code></pre><h2 id="features">Features</h2>
<p>YaraRET also includes the following features:</p>
<ul>
<li>Run Radare2 commands</li>
<li>Ssdeep distance checking</li>
<li>VirusTotal API integration</li>
<li>Scripting</li>
<li>YaraForensics ruleset</li>
<li>Entropy</li>
</ul>
<p>You can find all the documentation about YaraRET in the following link: <a href="https://github.com/wolfvan/YaraRET/blob/master/docs/readTheDocs.md">https://github.com/wolfvan/YaraRET/blob/master/docs/readTheDocs.md</a></p>
<p>An stable version of code could be found in our Github repository.</p>

</div>


  <footer class="container">
  <div class="container navigation no-print">
  <h2>Navigation</h2>
  
  

    
    <a class="prev" href="https://yararules.com/2018/03/23/yara-endpoint/" title="Yara Endpoint">
      Previous
    </a>
    

    

  


</div>

  
</footer>

</article>
      <footer id="main-footer" class="container main_footer">
  

  <div class="container nav foot no-print">
  

  <a class="toplink" href="#">back to top</a>

</div>

  <div class="container credits">
  
<div class="container footline">
  
  Coded with <!-- raw HTML omitted --><!-- raw HTML omitted -->


</div>


  
<div class="container copyright">
  
  (c) 2017 YaraRules Project.


</div>


</div>

</footer>

    </main>
    


<script src="https://yararules.com/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


    
  </body>
</html>

