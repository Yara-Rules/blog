<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en-EN lang=en-en><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta name=generator content="Hugo 0.81.0"><meta name=viewport content="width=device-width,initial-scale=1"><title>YaraRET &#183; YaraRules Project</title><meta name=description content><link type=text/css rel=stylesheet href=https://yara-rules.github.io/css/print.css media=print><link type=text/css rel=stylesheet href=https://yara-rules.github.io/css/poole.css><link type=text/css rel=stylesheet href=https://yara-rules.github.io/css/syntax.css><link type=text/css rel=stylesheet href=https://yara-rules.github.io/css/hyde.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700"><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body><aside class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://yara-rules.github.io/><h1>YaraRules Project</h1></a><p class=lead>Official Website</p></div><nav><ul class=sidebar-nav><li><a href=https://yara-rules.github.io/>Home</a></li><li><a href=/project>Project</a></li><li><a href=https://github.com/Yara-Rules/rules>Repository</a></li><li><a href=/post>Posts</a></li><li><a href=/contribute>Contribute</a></li><li><a href=/contact>Contact</a></li></ul></nav><p>&copy; 2021. All rights reserved.</p></div></aside><main class="content container"><div class=post><h1>YaraRET</h1><time datetime=2018-10-30T22:43:54+0100 class=post-date>Tue, Oct 30, 2018</time><p>For this forensics cases which are based in unreliable evidences, we decided to carry out the development of a carving tool for getting files from a raw disk using IoC detection.</p><p>YaraRET itâ€™s based in Radare2 and Yara, and it provides 58 magic number&rsquo;s rules for detecting 58 types of files.
This tool relies on the idea of a first stage detecting files using its magic numbers and a second stage, selecting or discarding those detected files using Yara, IoCs or its entropy value. After that, we can generate the hash, the ssdeep to check it over another files or upload the structure to VirusTotal.</p><p>YaraRET can be used as a oneliner or in a shell mode.</p><h2 id=oneliner>Oneliner</h2><p>If you want to run a fast scan over a disk, you can execute YaraRET in oneliner mode.</p><p>In this case, YaraRET runs the ruleset marked as yarafile and, if some rule has a match, YaraRET will look for magic numbers for detecting file structures around this match. If some result has been found, YaraRET will dump this file.</p><pre><code>$  ./yaraRET yara myYaraRule rawdisk myRaw maxsize maxsizeValue 
</code></pre><p>In the following example, YaraRET has searched for files related to TRISIS malware and a pyc file has been found.</p><p>Like with yara rules, YaraRET can parse a file with domains or IPs in it, for look for them in a raw disk.</p><pre><code>$ ./yaraRET ioc ./myIOC.stix rawdisk myRaw maxsize maxsizeValue
</code></pre><h2 id=shell-mode>Shell Mode</h2><p>For running a complex analysis, YaraRET adds a shell mode which allows selection of file structures based in Yara or IoC detection or its entropy. Also, provides a flexible way for footer assignment.</p><pre><code>$ ./yaraRET rawdisk myRaw shell
</code></pre><h2 id=features>Features</h2><p>YaraRET also includes the following features:</p><ul><li>Run Radare2 commands</li><li>Ssdeep distance checking</li><li>VirusTotal API integration</li><li>Scripting</li><li>YaraForensics ruleset</li><li>Entropy</li></ul><p>You can find all the documentation about YaraRET in the following link: <a href=https://github.com/wolfvan/YaraRET/blob/master/docs/readTheDocs.md>https://github.com/wolfvan/YaraRET/blob/master/docs/readTheDocs.md</a></p><p>An stable version of code could be found in our Github repository.</p></div></main></body></html>